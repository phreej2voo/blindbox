"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[7286,2392],{6516:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var l=a(6252),i=a(3577);const s=e=>((0,l.dD)("data-v-98b1e654"),e=e(),(0,l.Cn)(),e),o=(0,l.Uk)("查询"),n=(0,l.Uk)(" 添加合成 "),d=s((()=>(0,l._)("div",{style:{width:"100%",height:"0","border-bottom":"#e4e7ed 1px dashed","margin-top":"15px","margin-bottom":"15px"}},null,-1))),c={class:"table-body"},r=(0,l.Uk)("上线"),p=(0,l.Uk)("下线"),u=(0,l.Uk)(" 合成详情 "),m=(0,l.Uk)(" 编辑 "),h=(0,l.Uk)(" 删除 "),g={class:"pagination-class"},w={class:"click-bar"},f=(0,l.Uk)("返回 "),k={style:{"font-size":"14px","font-weight":"700"}};function _(e,t,a,s,_,y){const b=(0,l.up)("el-input"),v=(0,l.up)("el-form-item"),W=(0,l.up)("el-option"),C=(0,l.up)("el-select"),x=(0,l.up)("el-date-picker"),L=(0,l.up)("el-button"),V=(0,l.up)("el-form"),F=(0,l.up)("el-table-column"),z=(0,l.up)("el-image"),U=(0,l.up)("el-tag"),$=(0,l.up)("el-table"),S=(0,l.up)("el-pagination"),T=(0,l.up)("el-card"),j=(0,l.up)("el-icon-arrow-left"),D=(0,l.up)("el-icon"),q=(0,l.up)("el-divider"),A=(0,l.up)("advance-condition"),B=(0,l.up)("log-dialog"),M=(0,l.up)("el-main"),P=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.j4)(M,null,{default:(0,l.w5)((()=>[1==_.type?((0,l.wg)(),(0,l.j4)(T,{key:0,shadow:"never",style:{"margin-top":"10px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{ref:"searchForm",inline:!0,model:_.searchForm,class:"demo-form-inline","label-width":"80px"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{label:"名称",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{modelValue:_.searchForm.name,"onUpdate:modelValue":t[0]||(t[0]=e=>_.searchForm.name=e),placeholder:"",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(v,{label:"状态",prop:"status"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{modelValue:_.searchForm.status,"onUpdate:modelValue":t[1]||(t[1]=e=>_.searchForm.status=e),placeholder:"请选择",clearable:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{label:"上线",value:"1"}),(0,l.Wm)(W,{label:"下线",value:"2"})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(v,{label:"活动时间",prop:"activity_time"},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{modelValue:_.searchForm.activity_time,"onUpdate:modelValue":t[2]||(t[2]=e=>_.searchForm.activity_time=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",onChange:y.dateChange},null,8,["modelValue","onChange"])])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(L,{type:"primary",onClick:y.searchList},{default:(0,l.w5)((()=>[o])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"]),(0,l.Wm)(L,{type:"primary",onClick:y.addAdvance,icon:"el-icon-plus"},{default:(0,l.w5)((()=>[n])),_:1},8,["onClick"]),d,(0,l._)("div",c,[(0,l.wy)(((0,l.wg)(),(0,l.j4)($,{class:"table-info",data:_.list,style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{label:"id",prop:"id",width:"50"}),(0,l.Wm)(F,{prop:"sort",label:"排序"}),(0,l.Wm)(F,{label:"图片",prop:"image"},{default:(0,l.w5)((t=>[(0,l.Wm)(z,{style:{width:"50px",height:"50px"},src:t.row.image,fit:e.fit},null,8,["src","fit"])])),_:1}),(0,l.Wm)(F,{label:"标题",prop:"name",width:"200","show-overflow-tooltip":""}),(0,l.Wm)(F,{label:"价格",prop:"price",width:"130"},{default:(0,l.w5)((e=>[(0,l._)("div",null,(0,i.zw)(e.row.price),1)])),_:1}),(0,l.Wm)(F,{label:"活动时间",prop:"activity_time",width:"280","show-overflow-tooltip":""},{default:(0,l.w5)((e=>[(0,l._)("span",null,(0,i.zw)(e.row.start_time)+" / "+(0,i.zw)(e.row.end_time),1)])),_:1}),(0,l.Wm)(F,{label:"总库存",prop:"stock",width:"120"},{default:(0,l.w5)((e=>[(0,l._)("div",null,(0,i.zw)(e.row.stock),1)])),_:1}),(0,l.Wm)(F,{label:"已合成数",prop:"sales",width:"120"}),(0,l.Wm)(F,{label:"状态",prop:"status",width:"150"},{default:(0,l.w5)((e=>[1==e.row.status?((0,l.wg)(),(0,l.j4)(U,{key:0,type:"success"},{default:(0,l.w5)((()=>[r])),_:1})):(0,l.kq)("",!0),2==e.row.status?((0,l.wg)(),(0,l.j4)(U,{key:1,type:"danger"},{default:(0,l.w5)((()=>[p])),_:1})):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(F,{label:"操作",width:"230",fixed:"right"},{default:(0,l.w5)((e=>[(0,l.Wm)(L,{type:"text",size:"small",onClick:t=>y.log(e.row)},{default:(0,l.w5)((()=>[u])),_:2},1032,["onClick"]),(0,l.Wm)(L,{type:"text",size:"small",onClick:t=>y.editRow(e.row)},{default:(0,l.w5)((()=>[m])),_:2},1032,["onClick"]),(0,l.Wm)(L,{type:"text",size:"small",onClick:t=>y.delRow(e.row)},{default:(0,l.w5)((()=>[h])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[P,_.listLoading]])]),(0,l._)("div",g,[(0,l.Wm)(S,{style:{"margin-top":"10px"},background:"",layout:"->, prev, pager, next","page-size":_.pager.limit,total:_.pager.total,onCurrentChange:y.handlePageChange},null,8,["page-size","total","onCurrentChange"])])])),_:1})):(0,l.kq)("",!0),2==_.type?((0,l.wg)(),(0,l.j4)(T,{key:1,shadow:"false",style:{display:"flex"}},{default:(0,l.w5)((()=>[(0,l._)("div",w,[(0,l._)("div",{onClick:t[3]||(t[3]=e=>_.type=1)},[(0,l.Wm)(D,{class:"back-icon"},{default:(0,l.w5)((()=>[(0,l.Wm)(j)])),_:1}),f]),(0,l.Wm)(q,{direction:"vertical"}),(0,l._)("span",k,(0,i.zw)(_.backTitle),1)])])),_:1})):(0,l.kq)("",!0),2==_.type?((0,l.wg)(),(0,l.j4)(T,{key:2,shadow:"false",style:{"margin-top":"10px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(A,{ref:"advance",onSuccessBack:y.saveGoods},null,8,["onSuccessBack"])])),_:1})):(0,l.kq)("",!0),_.logVisiable?((0,l.wg)(),(0,l.j4)(B,{key:3,ref:"logDialog",onSuccess:y.handleSendSuccess,onClosed:t[4]||(t[4]=e=>_.logVisiable=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)])),_:1})}var y=a(2886),b=a(4435),v={name:"index",components:{AdvanceCondition:y["default"],logDialog:b["default"]},data(){return{type:1,backTitle:"",logVisiable:!1,pager:{page:1,limit:15,total:0},searchForm:{name:"",status:"",activity_time:""},list:[],page:1,sort:0,keyword:"",cats_id:"",listLoading:!1,pagination:{},search:"",id:"",stock:"",sellStock:"",sell_stock_id:"",stock_id:"",catsList:[]}},created(){this.getList()},methods:{dateChange(e){console.log("val-",e)},getList(){this.listLoading=!0;const e={name:this.searchForm.name,status:this.searchForm.status,activity_time:this.searchForm.activity_time,page:this.pager.page,limit:this.pager.limit};this.$API.conflate.conflateList.get(e).then((e=>{const{code:t,data:a}=e;0==t&&(this.list=a.data,this.pager.total=a.total),this.listLoading=!1})).catch((()=>{this.listLoading=!1}))},searchList(){this.getList()},addAdvance(){this.type=2,this.backTitle="添加碎片合成条件",this.$nextTick((()=>{this.$refs.advance.setMode("add")}))},editRow(e){this.type=2,this.backTitle="编辑碎片合成条件",this.$nextTick((()=>{this.$refs.advance.setMode("edit",e)}))},delRow(e){this.$confirm("确定删除当前碎片活动?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const{code:t,msg:a}=await this.$API.conflate.conflateDel.get({id:e.id});0==t?(this.$message.success(a),this.getList()):this.$message.error(a)})).catch((()=>{}))},log(e){this.logVisiable=!0,this.$nextTick((()=>{this.$refs.logDialog.open().setData(e)}))},handleSendSuccess(){this.logVisiable=!1},handlePageChange(e){this.pager.page=e,this.getList()},saveGoods(){this.type=1,this.pager.page=1,this.getList()}}},W=a(3744);const C=(0,W.Z)(v,[["render",_],["__scopeId","data-v-98b1e654"]]);var x=C}}]);